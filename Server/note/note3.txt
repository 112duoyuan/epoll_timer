TCP固定头部结构

tcpdump观察TCP头部信息
---------------------------------------------------------
IP 127.0.0.1.41621＞127.0.0.1.23:Flags[S],seq 3499745539,win
32792,options[mss 16396,sackOK,TS val 40781017 ecr 0,nop,wscale
6],length 0
0x0000:4510 003c a5da 4000 4006 96cf 7f00 0001
0x0010:7f00 0001 a295 0017 d099 e103 0000 0000
0x0020:a002 8018 fe30 0000 0204 400c 0402 080a
0x0030:026e 44d9 0000 0000 0103 0306
---------------------------------------------------------
Flags[S]，表示该TCP报文段包含SYN标志

tcpdump观察TCP连接的建立和关闭

 tcpdump-i eth0-nt'(src 192.168.1.109 and dst
192.168.1.108)or(src 192.168.1.108 and dst 192.168.1.109)'

---------------------------------------------------------------
1.IP 192.168.1.108.60871＞192.168.1.109.80:Flags[S],seq
535734930,win 5840,length 0
2.IP 192.168.1.109.80＞192.168.1.108.60871:Flags[S.],seq
2159701207,ack 535734931,win 5792,length 0
3.IP 192.168.1.108.60871＞192.168.1.109.80:Flags[.],ack 1,win
92,length 0
4.IP 192.168.1.108.60871＞192.168.1.109.80:Flags[F.],seq 1,ack
1,win 92,length 0
5.IP 192.168.1.109.80＞192.168.1.108.60871:Flags[.],ack 2,win
91,length 0
6.IP 192.168.1.109.80＞192.168.1.108.60871:Flags[F.],seq 1,ack
2,win 91,length 0
7.IP 192.168.1.108.60871＞192.168.1.109.80:Flags[.],ack 2,win
92,length 0
-----------------------------------------------------------------
连接建立三次握手

过滤数据包，客户端无法获得任何确认报文
iptables-F
iptables-I INPUT-p tcp--syn-i eth0-j DROP

TCP超时重传
----------------------------------------------------------------
1.21:23:35.612136 IP 192.168.1.109.39385＞
192.168.1.108.telnet:Flags[S],seq 1355982096，length 0
2.21:23:36.613146 IP 192.168.1.109.39385＞
192.168.1.108.telnet:Flags[S],seq 1355982096,length 0
3.21:23:38.617279 IP 192.168.1.109.39385＞
192.168.1.108.telnet:Flags[S],seq 1355982096,length 0
4.21:23:42.625140 IP 192.168.1.109.39385＞
192.168.1.108.telnet:Flags[S],seq 1355982096,length 0
5.21:23:50.641344 IP 192.168.1.109.39385＞
192.168.1.108.telnet:Flags[S],seq 1355982096,length 0
6.21:24:06.673331 IP 192.168.1.109.39385＞
192.168.1.108.telnet:Flags[S],seq 1355982096,length 0
----------------------------------------------------------------

TCP状态转移

TCP超时重传
iperf-s            #默认监听5001端口，-s作为服务器运行，丢弃端口接收到所有数据

chapt3 done!

